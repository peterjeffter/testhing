<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airdrop</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <h2 class="crownbal">1,800 crowns</h2>
    <img src="icons/crown.png" alt="">
    
    <!-- Connect wallet button for WalletConnect -->
    <button id="connectWallet" class="connectbtn">
        <img src="icons/money.png" alt="">Connect Wallet
    </button>

    <!-- Display wallet address and balance -->
    <p id="walletAddress"></p>
    <p id="walletBalance"></p>

    <div class="footer">
        <a href="main.html">
            <div class="minediv"><img src="icons/mining.png" alt="" class="mine"></a>Mine</div>
        <a href="tasks.html">
            <div class="tsks"><img src="icons/task.png" alt="" class="kgdmicon"></a>Tasks</div>
        <a href="">
            <div class="ardrp"><img src="icons/airdrop.png" alt="" class="ardrpimg"></a>Airdrop</div>
        <a href="friends.html">
            <div class="friendsdiv"><img src="icons/friends.png" alt="" class="friends"></a>Friends</div>
    </div>

    <!-- Include Ethers.js for Web3 functionality -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.0/dist/ethers.min.js"></script>
    
    <!-- Include WalletConnect library -->
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.7.8/dist/umd/index.min.js"></script>
    
    <!-- Main JS for wallet connection -->
    <script>

        // Global variables for wallet connection
let provider, signer, userAddress, userBalance;

// Function to connect using WalletConnect
async function connectWithWalletConnect() {
    try {
        // Initialize WalletConnect provider
        const walletConnectProvider = new WalletConnectProvider({
            infuraId: "YOUR_INFURA_ID",  // Required for WalletConnect to work
        });

        // Enable WalletConnect session (QR code pop-up)
        await walletConnectProvider.enable();

        // Create an ethers provider using WalletConnect
        provider = new ethers.providers.Web3Provider(walletConnectProvider);
        signer = provider.getSigner();

        // Get the connected wallet address
        userAddress = await signer.getAddress();
        document.getElementById("walletAddress").innerText = `Wallet Address: ${userAddress}`;

        // Get the wallet balance
        const balance = await provider.getBalance(userAddress);
        userBalance = ethers.utils.formatEther(balance);  // Convert balance to Ether
        document.getElementById("walletBalance").innerText = `Balance: ${userBalance} ETH`;
    } catch (error) {
        console.error("Error connecting with WalletConnect:", error);
        alert("Failed to connect wallet. Please try again.");
    }
}

// Add event listener for the connect button
document.getElementById("connectWallet").addEventListener("click", connectWithWalletConnect);

    </script>
</body>
</html>
